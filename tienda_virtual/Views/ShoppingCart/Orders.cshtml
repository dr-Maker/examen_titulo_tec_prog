
@{
    Layout = "~/Views/Shared/_layout.cshtml";
    List<ShoppingCartModel> ListOrdenes = ViewBag.ListOrdenes;
    List<ProductModel> ListProduct = ViewBag.ListProduct;

    int contador = 0;
}

    <div class="w-100 height background-color" >
        <h1 class="txt-center">Mis Pedidos</h1>

        <div class="contenedor-ordenes-usuario">
            <table class="tab table-order-user">
                <thead class="txt-center">
                    <tr>
                        <th>Id Pedido</th>
                        <th>Id Producto</th>
                        <th>Imagen</th>
                        <th>Nombre producto</th>
                        <th>descripción </th>
                        <th>Talla </th>
                        <th>marca </th>
                        <th>cantidad </th>
                        <th>Precio </th>
                        <th>SubTotal </th>
                        <th>Total </th>
                        <th>Fecha Pedido </th>
                        <th>Estado Pago </th>
                        <th>Estado Pedido Envío</th>
                        <th>Dirección Envío</th>
                    </tr>
                </thead>
                <tbody class="txt-center">

                    @foreach (var ordenes in ListOrdenes)
                    {
                    <tr>

                        @foreach (var producto in ordenes.Productos)
                        {

                            if (ordenes.Cest_count == 1)
                            {
                                <td>@ordenes.Id_cart</td>
                                <td>@producto.Id_product</td>
                                <td>
                                    <div >
                                        <img src="~/Assets/uploads/@producto.Imagen" />
                                    </div>
                                </td>
                                <td>@producto.Name_product</td>
                                <td>@producto.Pdto_description</td>
                                <td>@producto.Talla.Size</td>
                                <td>@producto.Brand.Brand</td>
                                <td>@producto.Cantidad</td>
                                <td>$ @producto.Price.ToString("N0")</td>
                                <td>$ @producto.SubTotal.ToString("N0")</td>
                                <td>$ @ordenes.Total.ToString("N0")</td>
                                <td>@ordenes.FechaPedido.ToString("dd-MM-yyy")</td>
                                <td>@ordenes.EstadoPago</td>
                                <td>@ordenes.EstadoPedido.Estado_orden</td>
                                <td>@ordenes.Usuario.Comuna.Nombre_comuna, @ordenes.Usuario.Addres</td>
                              


                            }
                            else
                            {
                                if (contador == 0)
                                {

                                    <td rowspan="@ordenes.Cest_count">@ordenes.Id_cart</td>
                                    <td>@producto.Id_product</td>
                                    <td>
                                        <div>
                                            <img src="~/Assets/uploads/@producto.Imagen" />
                                        </div>
                                    </td>
                                    <td>@producto.Name_product</td>
                                    <td>@producto.Pdto_description</td>
                                    <td>@producto.Talla.Size</td>
                                    <td>@producto.Brand.Brand</td>
                                    <td>@producto.Cantidad</td>
                                    <td>$ @producto.Price.ToString("N0")</td>
                                    <td>$ @producto.SubTotal.ToString("N0")</td>
                                    <td>$ @ordenes.Total.ToString("N0")</td>
                                    <td rowspan="@ordenes.Cest_count">@ordenes.FechaPedido.ToString("dd-MM-yyy")</td>
                                    <td rowspan="@ordenes.Cest_count">@ordenes.EstadoPago</td>
                                    <td rowspan="@ordenes.Cest_count">@ordenes.EstadoPedido.Estado_orden</td>
                                    <td rowspan="@ordenes.Cest_count">@ordenes.Usuario.Comuna.Nombre_comuna, @ordenes.Usuario.Addres</td>


                                    contador = contador + 1;

                                }
                                else
                                {

                                    <td>@producto.Id_product</td>
                                    <td>
                                        <div>
                                            <img src="~/Assets/uploads/@producto.Imagen" />
                                        </div>
                                    </td>
                                    <td>@producto.Name_product</td>
                                    <td>@producto.Pdto_description</td>
                                    <td>@producto.Talla.Size</td>
                                    <td>@producto.Brand.Brand</td>
                                    <td>@producto.Cantidad</td>
                                    <td>$ @producto.Price.ToString("N0")</td>
                                    <td>$ @producto.SubTotal.ToString("N0")</td>
                                    <td>$ @ordenes.Total.ToString("N0")</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>

                                    contador = contador + 1;
                                    if (contador == ordenes.Cest_count)
                                    {
                                        contador = 0;
                                    }
                                }
                            }
                        }
                    </tr>
                    }
                </tbody>
            </table>
        </div>


    </div>
